<div 
  class="upload-container" 
  [class.is-dragging]="isDragging()"
  (drop)="onDrop($event)" 
  (dragover)="onDragOver($event)" 
  (dragleave)="onDragLeave()">

  @if (cameraActive()) {
    <div class="camera-view">
      <video #video autoplay muted playsinline></video>
      <canvas #canvas style="display: none;"></canvas>
      <div class="camera-controls">
        <button (click)="capturePhoto()">Capturar</button>
        <button (click)="closeCamera()">Cancelar</button>
      </div>
    </div>
  } @else {
    <div class="file-view">
      @if (previewUrl(); as url) {
        <div class="preview-container">
          <img [src]="url" alt="Vista previa de la imagen seleccionada">
          <button class="remove-btn" (click)="selectedFile.set(null)">×</button>
        </div>
      } @else {
        <div class="drop-zone" (click)="triggerFileDialog()">
          <p>Arrastra una imagen aquí o haz clic para seleccionar</p>
          <button type="button" (click)="$event.stopPropagation(); openCamera()">Abrir Cámara</button>
          <input #fileInput type="file" accept="image/*" (change)="onFileSelected($event)" hidden>
        </div>
      }
    </div>
  }

  <div class="actions">
    <button (click)="uploadImage()" [disabled]="!selectedFile() || isUploading()">
      @if (isUploading()) {
        <span>Subiendo...</span>
      } @else {
        <span>Subir Imagen</span>
      }
    </button>

    @if (errorMsg(); as error) {
      <p class="error-message">{{ error }}</p>
    }
  </div>
</div>