<div class="dialog-container">
  <h2 mat-dialog-title>{{ title }}</h2>
  
  <mat-dialog-content class="dialog-content">
    
    <!-- FORMULARIO PARA ÓRDENES -->
    <div class="add-item-form" *ngIf="data.isOrder">
      <mat-form-field appearance="outline" class="field-nombre">
        <mat-label>Nombre {{ itemLabel }}</mat-label>
        <input 
          matInput 
          [(ngModel)]="newOrder.nombre" 
          placeholder="Ingrese nombre"
          (keyup.enter)="agregarItem()">
      </mat-form-field>

      <mat-form-field appearance="outline" class="field-monto">
        <mat-label>Monto</mat-label>
        <input 
          matInput 
          type="number" 
          [(ngModel)]="newOrder.monto" 
          placeholder="0.00"
          (keyup.enter)="agregarItem()">
        <span matPrefix>S/&nbsp;</span>
      </mat-form-field>

      <button 
        mat-raised-button 
        color="primary" 
        (click)="agregarItem()"
        [disabled]="!isFormValid()">
        <mat-icon>add</mat-icon>
        Agregar {{ itemLabel }}
      </button>
    </div>

    <!-- FORMULARIO PARA PLANILLAS (4 CAMPOS EN UNA FILA) -->
    <div class="add-item-form planilla-form" *ngIf="!data.isOrder">
      <mat-form-field appearance="fill" class="field-quarter">
        <mat-label>Nombres</mat-label>
        <input 
          matInput 
          [(ngModel)]="newPayroll.nombres" 
          placeholder="Ingrese nombres"
          (keyup.enter)="agregarItem()">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field-quarter">
        <mat-label>Apellidos</mat-label>
        <input 
          matInput 
          [(ngModel)]="newPayroll.apellidos" 
          placeholder="Ingrese apellidos"
          (keyup.enter)="agregarItem()">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field-quarter">
        <mat-label>Cargo</mat-label>
        <input 
          matInput 
          [(ngModel)]="newPayroll.cargo" 
          placeholder="Ingrese cargo"
          (keyup.enter)="agregarItem()">
      </mat-form-field>

      <mat-form-field appearance="fill" class="field-quarter">
        <mat-label>Monto Pago</mat-label>
        <input 
          matInput 
          type="number" 
          [(ngModel)]="newPayroll.montoPago" 
          placeholder="0.00"
          (keyup.enter)="agregarItem()">
        <span matPrefix>S/&nbsp;</span>
      </mat-form-field>

      <button 
        mat-raised-button 
        color="primary" 
        (click)="agregarItem()"
        [disabled]="!isFormValid()">
        <mat-icon>add</mat-icon>
        Agregar
      </button>
    </div>

    <!-- LISTA DE ÓRDENES AGREGADAS -->
    <div class="items-list" *ngIf="data.isOrder && orderItems.length > 0">
      <h3>{{ itemLabel }}s Agregadas ({{ orderItems.length }})</h3>
      
      <div class="item-card" *ngFor="let item of orderItems; let i = index">
        <div class="item-info">
          <span class="item-nombre">{{ item.nombre }}</span>
          <span class="item-monto">S/ {{ item.monto | number:'1.2-2' }}</span>
        </div>
        <button 
          mat-icon-button 
          color="warn" 
          (click)="eliminarItem(i)"
          matTooltip="Eliminar">
          <mat-icon>delete</mat-icon>
        </button>
      </div>

      <div class="total-section">
        <span class="total-label">Total:</span>
        <span class="total-amount">S/ {{ getTotalMonto() | number:'1.2-2' }}</span>
      </div>
    </div>

    <!-- LISTA DE PLANILLAS AGREGADAS -->
    <div class="items-list" *ngIf="!data.isOrder && payrollItems.length > 0">
      <h3>{{ itemLabel }}s Agregadas ({{ payrollItems.length }})</h3>
      
      <!-- Tabla de planillas -->
      <div class="table-container">
        <table class="payroll-table">
          <thead>
            <tr>
              <th class="col-item">ÍTEM</th>
              <th class="col-name">NOMBRES Y APELLIDOS</th>
              <th class="col-cargo">CARGO</th>
              <th class="col-monto">PAGO</th>
              <th class="col-actions"></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of payrollItems; let i = index">
              <td class="col-item">{{ i + 1 }}</td>
              <td class="col-name">{{ item.nombres }} {{ item.apellidos }}</td>
              <td class="col-cargo">{{ item.cargo }}</td>
              <td class="col-monto">S/ {{ item.montoPago | number:'1.2-2' }}</td>
              <td class="col-actions">
                <button 
                  mat-icon-button 
                  color="warn" 
                  (click)="eliminarItem(i)"
                  matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="total-section">
        <span class="total-label">Total:</span>
        <span class="total-amount">S/ {{ getTotalMonto() | number:'1.2-2' }}</span>
      </div>
    </div>

    <!-- MENSAJE CUANDO NO HAY ITEMS -->
    <div class="empty-state" *ngIf="items.length === 0">
      <mat-icon>inbox</mat-icon>
      <p>No hay {{ itemLabel.toLowerCase() }}s agregadas</p>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancelar</button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onSave()"
      [disabled]="items.length === 0">
      Guardar ({{ items.length }})
    </button>
  </mat-dialog-actions>
</div>